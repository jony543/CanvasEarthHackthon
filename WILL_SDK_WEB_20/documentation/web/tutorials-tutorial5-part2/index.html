<!DOCTYPE html>
<!--[if IE 7]>
<html class="ie ie7" lang="en-US">
<![endif]-->
<!--[if IE 8]>
<html class="ie ie8" lang="en-US">
<![endif]-->
<!--[if !(IE 7) & !(IE 8)]><!-->
<html lang="en-US">
<!--<![endif]-->
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width">
	<title>Creating image masks | WILL SDK Docs</title>
	<link rel="profile" href="http://gmpg.org/xfn/11">
	<link rel="pingback" href="http://localhost/will_docs_instance1/xmlrpc.php">
	<!--[if lt IE 9]>
	<script src="http://localhost/will_docs_instance1/wp-content/themes/will-doc/js/html5.js"></script>
	<![endif]-->

	<link rel="stylesheet" href="../../wp-content/themes/will-doc/css/style.css">
	<link rel="stylesheet" href="../../wp-content/themes/will-doc/css/accordionmenu.css">

	<script src="../../wp-content/themes/will-doc/js/jquery.min.js"></script>
	<script src="../../wp-content/themes/will-doc/js/sidebar.js"></script>

	<link rel="stylesheet" href="../../wp-content/themes/will-doc/css/highlight.css">
	<script src="../../wp-content/themes/will-doc/js/highlight.pack.js"></script>
	<script>hljs.initHighlightingOnLoad();</script>
</head>

<body>
	<header>
		<div class="title">
			<div>WILL &trade;</div>
			<div>sdk documentation</div>
		</div>
		<!--
		<div id="searchbox">
			<input class="typeahead" type="text" placeholder="{{ search_text }}">
		</div>
-->
	</header>

	<div id="sitewrapper">
<div id="sidebar">
	<nav class="accordion">

				<h1 class="do-not-cause-collapse" title="General Concepts">

			General Concepts
			</h1>

							<div class="active-menu never-close">
					<h2 class="not-collapsible" title="Architectural Overview">

								<a href="../../general-concepts/architecture/index.html"
											>Architectural Overview</a>
					
			</h2>

						<h2 class="not-collapsible" title="Generating ink content">

								<a href="../../general-concepts/path-building/index.html"
											>Generating ink content</a>
					
			</h2>

						<h2 class="not-collapsible" title="Rendering ink content">

								<a href="../../general-concepts/rasterizer/index.html"
											>Rendering ink content</a>
					
			</h2>

						<h2 class="not-collapsible" title="Encoding and decoding ink content">

								<a href="../../general-concepts/serialization/index.html"
											>Encoding and decoding ink content</a>
					
			</h2>

						<h2 class="not-collapsible" title="Exchanging ink content">

								<a href="../../general-concepts/file-format/index.html"
											>Exchanging ink content</a>
					
			</h2>

							</div>
							<h1 title="Web SDK">

			Web SDK
			</h1>

							<div>
					<h2 title="Getting started">

								<a href="../getting-started/index.html"
											>Getting started</a>
					
			</h2>

						<h2 title="Release Notes">

								<a href="../release-notes/index.html"
											>Release Notes</a>
					
			</h2>

						<h2 title="Tutorials">

								<a href="../tutorials-overview/index.html"
											>Tutorials</a>
					
			</h2>

							<div>
					<h3 title="Tutorial 1: Drawing with pointing devices">

								<a href="../tutorials-tutorial1/index.html"
											>Tutorial 1: Drawing with pointing devices</a>
					
			</h3>

							<div>
					<h4 title="Part 1: Setting up the ink engine">

								<a href="../tutorials-tutorial1-part1/index.html"
											>Part 1: Setting up the ink engine</a>
					
			</h4>

						<h4 title="Part 2: Building paths from pointer input">

								<a href="../tutorials-tutorial1-part2/index.html"
											>Part 2: Building paths from pointer input</a>
					
			</h4>

						<h4 title="Part 3: Smoothing paths">

								<a href="../tutorials-tutorial1-part3/index.html"
											>Part 3: Smoothing paths</a>
					
			</h4>

						<h4 title="Part 4: Drawing preliminary paths">

								<a href="../tutorials-tutorial1-part4/index.html"
											>Part 4: Drawing preliminary paths</a>
					
			</h4>

						<h4 title="Part 5: Drawing semi-transparent strokes">

								<a href="../tutorials-tutorial1-part5/index.html"
											>Part 5: Drawing semi-transparent strokes</a>
					
			</h4>

						<h4 title="Part 6: Using a particle brush">

								<a href="../tutorials-tutorial1-part6/index.html"
											>Part 6: Using a particle brush</a>
					
			</h4>

						<h4 title="Part 7: Generating a Bezier path">

								<a href="../tutorials-tutorial1-part7/index.html"
											>Part 7: Generating a Bezier path</a>
					
			</h4>

							</div>
							<h3 title="Tutorial 2: Encoding and decoding strokes">

								<a href="../tutorials-tutorial2/index.html"
											>Tutorial 2: Encoding and decoding strokes</a>
					
			</h3>

							<div>
					<h4 title="Part 1: Creating a stroke model">

								<a href="../tutorials-tutorial2-part1/index.html"
											>Part 1: Creating a stroke model</a>
					
			</h4>

						<h4 title="Part 2: Serializing and deserializing strokes">

								<a href="../tutorials-tutorial2-part2/index.html"
											>Part 2: Serializing and deserializing strokes</a>
					
			</h4>

							</div>
							<h3 title="Tutorial 3: Erasing strokes">

								<a href="../tutorials-tutorial3/index.html"
											>Tutorial 3: Erasing strokes</a>
					
			</h3>

							<div>
					<h4 title="Part 1: Creating an eraser">

								<a href="../tutorials-tutorial3-part1/index.html"
											>Part 1: Creating an eraser</a>
					
			</h4>

						<h4 title="Part 2: Erasing parts of strokes">

								<a href="../tutorials-tutorial3-part2/index.html"
											>Part 2: Erasing parts of strokes</a>
					
			</h4>

							</div>
							<h3 title="Tutorial 4: Selecting strokes">

								<a href="../tutorials-tutorial4/index.html"
											>Tutorial 4: Selecting strokes</a>
					
			</h3>

							<div>
					<h4 title="Part 1: Selecting strokes">

								<a href="../tutorials-tutorial4-part1/index.html"
											>Part 1: Selecting strokes</a>
					
			</h4>

						<h4 title="Part 2: Selecting parts of strokes">

								<a href="../tutorials-tutorial4-part2/index.html"
											>Part 2: Selecting parts of strokes</a>
					
			</h4>

							</div>
							<h3 title="Tutorial 5: Working with rasters">

								<a href="../tutorials-tutorial5/index.html"
											>Tutorial 5: Working with rasters</a>
					
			</h3>

							<div>
					<h4 title="Part 1: Displaying raster images">

								<a href="../tutorials-tutorial5-part1/index.html"
											>Part 1: Displaying raster images</a>
					
			</h4>

						<h4 title="Part 2: Creating image masks">

								<a href="index.html"
						 class="selected"					>Part 2: Creating image masks</a>
					
			</h4>

							</div>
							<h3 title="Tutorial 6: Collaborating in real time">

								<a href="../tutorials-tutorial6/index.html"
											>Tutorial 6: Collaborating in real time</a>
					
			</h3>

							<div>
					<h4 title="Part 1: Composing strokes">

								<a href="../tutorials-tutorial6-part1/index.html"
											>Part 1: Composing strokes</a>
					
			</h4>

						<h4 title="Part 2: Erasing strokes">

								<a href="../tutorials-tutorial6-part2/index.html"
											>Part 2: Erasing strokes</a>
					
			</h4>

						<h4 title="Part 3: Erasing parts of strokes">

								<a href="../tutorials-tutorial6-part3/index.html"
											>Part 3: Erasing parts of strokes</a>
					
			</h4>

						<h4 title="Part 4: Selecting strokes">

								<a href="../tutorials-tutorial6-part4/index.html"
											>Part 4: Selecting strokes</a>
					
			</h4>

						<h4 title="Part 5: Selecting parts of strokes">

								<a href="../tutorials-tutorial6-part5/index.html"
											>Part 5: Selecting parts of strokes</a>
					
			</h4>

						<h4 title="Part 6: Composing strokes with latency">

								<a href="../tutorials-tutorial6-part6/index.html"
											>Part 6: Composing strokes with latency</a>
					
			</h4>

							</div>
								</div>
							<h2 title="API Reference">

			API Reference
			</h2>

							<div>
					<h3 title="Classes">

			Classes
			</h3>

							<div>
					<h4 title="BezierPath">

								<a href="../../web-api/Module.BezierPath/index.html"
											>BezierPath</a>
					
			</h4>

						<h4 title="BrushDecoder">

								<a href="../../web-api/Module.BrushDecoder/index.html"
											>BrushDecoder</a>
					
			</h4>

						<h4 title="BrushEncoder">

								<a href="../../web-api/Module.BrushEncoder/index.html"
											>BrushEncoder</a>
					
			</h4>

						<h4 title="DirectBrush">

								<a href="../../web-api/Module.DirectBrush/index.html"
											>DirectBrush</a>
					
			</h4>

						<h4 title="FlatPath">

								<a href="../../web-api/Module.FlatPath/index.html"
											>FlatPath</a>
					
			</h4>

						<h4 title="GenericLayer">

								<a href="../../web-api/Module.GenericLayer/index.html"
											>GenericLayer</a>
					
			</h4>

						<h4 title="GenericPath">

								<a href="../../web-api/Module.GenericPath/index.html"
											>GenericPath</a>
					
			</h4>

						<h4 title="InkCanvas">

								<a href="../../web-api/Module.InkCanvas/index.html"
											>InkCanvas</a>
					
			</h4>

						<h4 title="InkDecoder">

								<a href="../../web-api/Module.InkDecoder/index.html"
											>InkDecoder</a>
					
			</h4>

						<h4 title="InkEncoder">

								<a href="../../web-api/Module.InkEncoder/index.html"
											>InkEncoder</a>
					
			</h4>

						<h4 title="Intersector">

								<a href="../../web-api/Module.Intersector/index.html"
											>Intersector</a>
					
			</h4>

						<h4 title="MultiChannelSmoothener">

								<a href="../../web-api/Module.MultiChannelSmoothener/index.html"
											>MultiChannelSmoothener</a>
					
			</h4>

						<h4 title="OffscreenLayer">

								<a href="../../web-api/Module.OffscreenLayer/index.html"
											>OffscreenLayer</a>
					
			</h4>

						<h4 title="ParticleBrush">

								<a href="../../web-api/Module.ParticleBrush/index.html"
											>ParticleBrush</a>
					
			</h4>

						<h4 title="PathBuilder">

								<a href="../../web-api/Module.PathBuilder/index.html"
											>PathBuilder</a>
					
			</h4>

						<h4 title="PathContext">

								<a href="../../web-api/Module.PathContext/index.html"
											>PathContext</a>
					
			</h4>

						<h4 title="PathOperationDecoder">

								<a href="../../web-api/Module.PathOperationDecoder/index.html"
											>PathOperationDecoder</a>
					
			</h4>

						<h4 title="PathOperationEncoder">

								<a href="../../web-api/Module.PathOperationEncoder/index.html"
											>PathOperationEncoder</a>
					
			</h4>

						<h4 title="PressurePathBuilder">

								<a href="../../web-api/Module.PressurePathBuilder/index.html"
											>PressurePathBuilder</a>
					
			</h4>

						<h4 title="SolidColorBrush">

								<a href="../../web-api/Module.SolidColorBrush/index.html"
											>SolidColorBrush</a>
					
			</h4>

						<h4 title="SpeedPathBuilder">

								<a href="../../web-api/Module.SpeedPathBuilder/index.html"
											>SpeedPathBuilder</a>
					
			</h4>

						<h4 title="Stroke">

								<a href="../../web-api/Module.Stroke/index.html"
											>Stroke</a>
					
			</h4>

						<h4 title="StrokeBrush">

								<a href="../../web-api/Module.StrokeBrush/index.html"
											>StrokeBrush</a>
					
			</h4>

						<h4 title="StrokeDrawContext">

								<a href="../../web-api/Module.StrokeDrawContext/index.html"
											>StrokeDrawContext</a>
					
			</h4>

						<h4 title="StrokeRenderer">

								<a href="../../web-api/Module.StrokeRenderer/index.html"
											>StrokeRenderer</a>
					
			</h4>

							</div>
							<h3 title="Interfaces">

			Interfaces
			</h3>

							<div>
					<h4 title="PathOperationDecoderCallbacksHandlerInterface">

								<a href="../../web-api/Module.PathOperationDecoderCallbacksHandlerInterface/index.html"
											>PathOperationDecoderCallbacksHandlerInterface</a>
					
			</h4>

							</div>
							<h3 title="Namespaces">

			Namespaces
			</h3>

							<div>
					<h4 title="Module">

								<a href="../../web-api/Module/index.html"
											>Module</a>
					
			</h4>

						<h4 title="Module.Color">

								<a href="../../web-api/Module.Color/index.html"
											>Module.Color</a>
					
			</h4>

						<h4 title="Module.GLTools">

								<a href="../../web-api/Module.GLTools/index.html"
											>Module.GLTools</a>
					
			</h4>

						<h4 title="Module.MatTools">

								<a href="../../web-api/Module.MatTools/index.html"
											>Module.MatTools</a>
					
			</h4>

						<h4 title="Module.RectTools">

								<a href="../../web-api/Module.RectTools/index.html"
											>Module.RectTools</a>
					
			</h4>

							</div>
							<h3 title="Global">

								<a href="../../web-api/global/index.html"
											>Global</a>
					
			</h3>

			
	</nav>
</div><div id="page_content" class='page-content tutorials web'>
	<div class="seealso"><h2>See Also</h2><p>For more information, see the following topics:</p><ul><li><a href="../../general-concepts/rasterizer/index.html">Rendering ink content</a></li><li><a href="../tutorials-tutorial4-part1/index.html">Selecting strokes</a></li></ul></div>
<div id="post-64" class="page">
	<h1>Working with rasters</h1>
<h2>Part 2: Creating image masks</h2>
<p>You want to mask a part of the image. To do this, you need a selection tool to define the area you want to extract.
This tutorial builds on the stroke selection tool that you built in <a href="../tutorials-tutorial4-part1/index.html">Part 1</a> of <a href="../tutorials-tutorial4/index.html">Tutorial 4: Selecting strokes</a>.</p>
<p>In Part 2 of this tutorial, you will learn how to select an area of an image and mask it.</p>
<h3>Step 1: Initiate the image layer</h3>
<p>In <a href="../tutorials-tutorial5-part1/index.html">Part 1</a> of this tutorial, you created a layer for an image with a predefined width and height.</p>
<p>In this part, use a different approach. When you load an image, you do not know the dimensions of the image at first.
Instead, create a layer only when you have determined the dimensions of the image.</p>
<h3>Step 2: Select a region of the canvas</h3>
<p>When a new selection begins, recover the canvas to the initial state. This step introduces the blend mode <code>MULTIPLY_NO_ALPHA</code>.</p>
<p>The code for these steps is as follows:</p>
<pre><code class="javascript">var WILL = {
    color: Module.Color.from(0, 151, 212),
    backgroundColor: Module.Color.from(190, 143, 1),

    strokeWidth: 1.25,

    init: function(width, height) {...},
    initInkEngine: function(width, height) {
        ...

        this.maskLayer = this.canvas.createLayer();
        this.initImageLayer();

        this.brush = new Module.DirectBrush();

        this.pathBuilder = new Module.SpeedPathBuilder();
        this.smoothener = new Module.MultiChannelSmoothener(this.pathBuilder.stride);

        this.strokeRenderer = new Module.StrokeRenderer(this.canvas, this.canvas);
        this.strokeRenderer.configure({brush: this.brush, color: this.color, width: this.strokeWidth});
    },

    initImageLayer: function() {
        var url = location.toString();
        url = url.substring(0, url.lastIndexOf("/")) + "/image.png";

        Module.GLTools.prepareTexture(
            Module.GLTools.createTexture(GLctx.CLAMP_TO_EDGE, GLctx.LINEAR),
            url,
            function(texture) {
                this.imageLayer = this.canvas.createLayer({texture: texture, ownGlResources: true});
                this.canvas.blend(this.imageLayer, {mode: Module.BlendMode.NONE});
            },
            this
        );
    },

    initEvents: function() {...},
    beginStroke: function(e) {...},
    moveStroke: function(e) {...},
    endStroke: function(e) {...},
    buildPath: function(pos) {...},
    drawPath: function() {...},

    select: function() {
        this.maskLayer.clear(Module.Color.from(0, 0, 0));
        this.maskLayer.fillPath(this.path, Module.Color.from(255, 255, 255), true);

        this.clear();
        this.canvas.blend(this.maskLayer, {mode: Module.BlendMode.MULTIPLY_NO_ALPHA});
    },

    clear: function() {
        this.canvas.clear(this.backgroundColor)
        this.canvas.blend(this.imageLayer, {mode: Module.BlendMode.NONE});
    }
};

Module.addPostScript(function() {...});</code></pre>
<p>The <code>Module.GLTools.createTexture</code> method creates a new, completed texture. This texture is accessible in callback,
and you can use the  <code>createLayer</code> method to define a layer with predefined data.
<code>ownGlResources</code> parameter tells the layer who is responsible for the memory management of this texture.
You can give this responsibility to the ink engine when the texture does not have any other purpose.</p>
<p>When your selection tool defines the area, you call the <code>fillPath</code> method with the whole path from the path builder.
The key step here is to draw the mask layer over the image layer using the <code>MULTIPLY_NO_ALPHA</code> blend mode.
This will cut out the part of the image closed by the path.</p>
<p><strong>Note:</strong> For the sake of clarity, method implementations from earlier in this tutorial are replaced with <code>...</code> in the example code above.</p>
<h2>View sample</h2>
<ul>
<li><a href="http://localhost/will_docs_instance1/web/tutorials/Sample5/part2.js">View complete source code</a></li>
<li><a href="../tutorials/Sample5/Part2.html">View sample</a></li>
</ul>
<h2>Next steps</h2>
<p>You can now progress to <a href="../tutorials-tutorial6/index.html">Tutorial 6: Collaborating in real time</a>.</p>
</div> <!-- page -->
			<nav class="prev-next-page">
									<a href="../tutorials-tutorial5-part1/index.html" class="prev-page">&laquo; Displaying raster images</a>
								</nav>
			</div> <!-- page_content -->

	</div><!-- #sitewrapper -->

	<footer>
		<img src="../../wp-content/themes/will-doc/images/img_logo_wacom.png" alt="" />
<!--
		<span>&nbsp;</span>
		<a href="/contact.html">Contact</a>
		<a href="/support.html">Support</a>
-->
	</footer>
</body>
</html>